<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Lab notebook</title>
    <link>https://sam217pa.github.io/lab-notebook/categories/meta/index.xml</link>
    <description>Recent content on Lab notebook</description>
    <generator>Hugo -- gohugo.io</generator>
    <atom:link href="https://sam217pa.github.io/lab-notebook/categories/meta/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Projet Bubendorfer</title>
      <link>https://sam217pa.github.io/lab-notebook/post/2016-11-02/</link>
      <pubDate>Wed, 02 Nov 2016 13:41:04 +0100</pubDate>
      
      <guid>https://sam217pa.github.io/lab-notebook/post/2016-11-02/</guid>
      <description>&lt;p&gt;Ordre du jour : faire l&amp;rsquo;état des lieux de l&amp;rsquo;avancement sur l&amp;rsquo;analyse des données de Bubendorfer &lt;em&gt;et al&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;J&amp;rsquo;ai téléchargé les génomes de référence du donneur et du receveur
publiés en 2003 et 1999 respectivement. J&amp;rsquo;ai ensuite téléchargé les
données publiées dans le papier de Bubendorfer. J&amp;rsquo;ai aligné chacun des
génomes indépendamment &amp;ndash; y compris le génome du donneur &amp;ndash; avec la
référence (le génome du receveur) en utilisant &lt;code&gt;bwa mem&lt;/code&gt;. J&amp;rsquo;ai ensuite
&amp;ldquo;empilé&amp;rdquo; les génomes sur la référence avec &lt;code&gt;samtools&lt;/code&gt;, ce qui m&amp;rsquo;a
permis de déterminer les positions variables avec &lt;code&gt;bcftools&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;J&amp;rsquo;ai donc maintenant un gros fichier &lt;code&gt;.vcf&lt;/code&gt; que j&amp;rsquo;ai importé dans R avec le package &lt;code&gt;VariantAnnotation&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;gt; vcf
class: CollapsedVCF
dim: 55655 63
rowRanges(vcf):
  GRanges with 5 metadata columns: paramRangeID, REF, ALT, QUAL, FILTER
info(vcf):
  DataFrame with 17 columns: INDEL, IDV, IMF, DP, VDB, RPB, MQB, BQB, MQSB, SGB, MQ0F,...
info(header(vcf)):
         Number Type    Description
   INDEL 0      Flag    Indicates that the variant is an INDEL.
   IDV   1      Integer Maximum number of reads supporting an indel
   IMF   1      Float   Maximum fraction of reads supporting an indel
   DP    1      Integer Raw read depth
   VDB   1      Float   Variant Distance Bias for filtering splice-site artefacts in R...
   RPB   1      Float   Mann-Whitney U test of Read Position Bias (bigger is better)
   MQB   1      Float   Mann-Whitney U test of Mapping Quality Bias (bigger is better)
   BQB   1      Float   Mann-Whitney U test of Base Quality Bias (bigger is better)
   MQSB  1      Float   Mann-Whitney U test of Mapping Quality vs Strand Bias (bigger ...
   SGB   1      Float   Segregation based metric.
   MQ0F  1      Float   Fraction of MQ0 reads (smaller is better)
   ICB   1      Float   Inbreeding Coefficient Binomial test (bigger is better)
   HOB   1      Float   Bias in the number of HOMs number (smaller is better)
   AC    A      Integer Allele count in genotypes for each ALT allele, in the same ord...
   AN    1      Integer Total number of alleles in called genotypes
   DP4   4      Integer Number of high-quality ref-forward , ref-reverse, alt-forward ...
   MQ    1      Integer Average mapping quality
geno(vcf):
  SimpleList of length 2: GT, PL
geno(header(vcf)):
      Number Type    Description
   GT 1      String  Genotype
   PL G      Integer List of Phred-scaled genotype likelihoods
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;J&amp;rsquo;ai ensuite splitté le jeu de donnée par clone, pour avoir ce genre de tableau :&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;gt; vr
CompressedVRangesList object of length 63:
$FLKJ01000001-FLKJ01000087.fasta
VRanges object with 55848 ranges and 20 metadata columns:
            seqnames             ranges strand         ref              alt
               &amp;lt;Rle&amp;gt;          &amp;lt;IRanges&amp;gt;  &amp;lt;Rle&amp;gt; &amp;lt;character&amp;gt; &amp;lt;characterOrRle&amp;gt;
      [1] CP003904.1         [182, 182]      *           T                C
      [2] CP003904.1         [205, 205]      *           T                C
      [3] CP003904.1         [213, 213]      *           A                G
      [4] CP003904.1         [218, 218]      *           C                T
      [5] CP003904.1         [221, 221]      *           T                A
      ...        ...                ...    ...         ...              ...
  [55844] CP003904.1 [1666966, 1666966]      *           C                T
  [55845] CP003904.1 [1666972, 1666972]      *           G                A
  [55846] CP003904.1 [1666973, 1666973]      *           T                C
  [55847] CP003904.1 [1666994, 1666994]      *           A                G
  [55848] CP003904.1 [1667001, 1667001]      *           C                T
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;La colonne importante et qu&amp;rsquo;on ne voit pas ici est là colonne GT, qui
permet de dire si la position séquencée correspond à l&amp;rsquo;allèle du
donneur, à une mutation ou à l&amp;rsquo;allèle du receveur. Les mutations
peuvent survenir &lt;em&gt;de novo&lt;/em&gt; dans le clone séquencé, ou provenir de la
divergence entre le génome du clone receveur et celui publié il y a 17
ans.&lt;/p&gt;

&lt;p&gt;On a donc vu avec Laurent et Vincent la suite des opérations.&lt;/p&gt;

&lt;p&gt;Le premier problème à régler est de de discriminer les sites
correspondants à de la conversion des sites correspondants à des
mutations, ancestrales ou &lt;em&gt;de novo&lt;/em&gt;. On peut les discriminer sur la
base de leur fréquence et de leur similarité avec le donneur. Les
conversions devraient être en fréquence faible et correspondrent à
l&amp;rsquo;allèle donneur. Les mutations &lt;em&gt;de novo&lt;/em&gt; devraient être différentes
du donneur et en faible fréquence. Les mutations ancestrales
devraient être en forte fréquence. On s&amp;rsquo;attend également à ce qu&amp;rsquo;au
moins 96% de ces mutations soient différentes de l&amp;rsquo;allèle du donneur.&lt;/p&gt;

&lt;p&gt;Le but est d&amp;rsquo;obtenir une liste de sites pour lesquels on est sûr
qu&amp;rsquo;ils correspondent à de la conversion. À partir de là, on peut
déterminer les évènements de recombinaison.&lt;/p&gt;

&lt;p&gt;Dans le papier, ils déterminent que deux marqueurs sont impliqués dans
le même évènement de recombinaison s&amp;rsquo;ils sont séparés par moins de
200bp, ou s&amp;rsquo;ils sont distants de plus de 200bp mais qu&amp;rsquo;aucun autre
marqueur n&amp;rsquo;est présent entre eux.&lt;/p&gt;

&lt;p&gt;J&amp;rsquo;utiliserai donc les mêmes critères, quitte à faire varier le seuil
arbitraire de 200bp pour vérifier que la distribution de la longueur
des évènements de recombinaison ne soit pas affectée par le seuil
choisi.&lt;/p&gt;

&lt;p&gt;L&amp;rsquo;idée est ensuite de compter les évènements de recombinaison partagés
et indépendants d&amp;rsquo;un clone à l&amp;rsquo;autre. Il se pourrait qu&amp;rsquo;une région ait
été acquise au cours des premiers stades de la manip, et transmise à
l&amp;rsquo;ensemble des clones séquencés (dans le &amp;ldquo;pire&amp;rdquo; des cas). Dans ce cas,
on compterait plusieurs évènements de recombinaison comme indépendants
alors qu&amp;rsquo;en fait, non. Au vu des résultats du papier, on ne s&amp;rsquo;attend
pas à ça. On va également contrôler pour ça avec la phylogénie globale
(génome entier), qui ne devrait pas donner de signal fort si les
évènements sont bien indépendants.&lt;/p&gt;

&lt;p&gt;À ce stade, on devrait être capable de déterminer la nature des bases
impliquées dans un évènement de recombinaison. On pourra donc
déterminer la proportion de substitutions Weak vers Strong et Strong
vers Weak, et comparer cette proportion avec la proportion de
substitutions WS et SW entre le donneur et le receveur. Ça peut être
fait globalement ou clone par clone s&amp;rsquo;ils s&amp;rsquo;avèrent non-indépendants.
Ça peut être fait également plus subtilement : chez la levure, le
biais était essentiellement observé au niveau des SNPs on bordure des
tracks.&lt;/p&gt;

&lt;p&gt;Au passage, je pourrai comparer la distribution de la longueur des
tracks de conversion avec celle obtenue dans le papier.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Compte-rendu réunion du 03 octobre</title>
      <link>https://sam217pa.github.io/lab-notebook/post/2016-10-04/</link>
      <pubDate>Tue, 04 Oct 2016 17:55:08 +0200</pubDate>
      
      <guid>https://sam217pa.github.io/lab-notebook/post/2016-10-04/</guid>
      <description>&lt;p&gt;Ordre du jour : discuter des stratégies pour mesurer le BGC &lt;em&gt;in-vitro&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;La stratégie Sanger a permis de déterminer la distribution des points de cassure, d&amp;rsquo;avoir une idée approximative de l&amp;rsquo;intensité du biais à laquelle on peut s&amp;rsquo;attendre&lt;label for=&#34;error: cannot access positional params by string name&#34; class=&#34;margin-toggle sidenote-number&#34;&gt;&lt;/label&gt;
&lt;input type=&#34;checkbox&#34; id=&#34;error: cannot access positional params by string name&#34; class=&#34;margin-toggle&#34;/&gt;
&lt;span class=&#34;sidenote&#34;&gt;C&amp;rsquo;est à dire faible, à priori.&lt;/span&gt; 
, mais elle ne permet pas d&amp;rsquo;atteindre la puissance suffisante.&lt;/p&gt;

&lt;p&gt;On veut donc partir sur une stratégie en NGS.&lt;/p&gt;

&lt;p&gt;&lt;span class=&#34;newthought&#34;&gt;L&amp;rsquo;école centrale&lt;/span&gt;
 à Écully dispose
d&amp;rsquo;un séquenceur MiSeq Illumina à 40 - 50€ le run de 2 x 300. Ce sont
les mêmes prix que ceux pratiqués par Mr DNA. On a une interlocutrice
là-bas avec qui discuter de la meilleure façon de préparer la
librairie. Le problème de la faible divergence de nos séquences est
résolu puisqu&amp;rsquo;ils seront mélangés à des séquences tierces. La
diversité dans la flow-cell sera donc suffisante.&lt;/p&gt;

&lt;p&gt;À ce prix, on peut envisager une manip&amp;rsquo; préliminaire qui donnerait une
idée de ce à quoi on peut s&amp;rsquo;attendre en NGS ; préliminaire à une
manip&amp;rsquo; qui s&amp;rsquo;effectuerait avec des reads taggés.&lt;/p&gt;

&lt;p&gt;Une question qui reste pour l&amp;rsquo;instant en suspens : est-ce que les
reads en paired-end doivent être chevauchants ou non ? Est-ce qu&amp;rsquo;on
peut laisser un gap entre les extrémités de la séquence ? S&amp;rsquo;il faut
nécessairement que les reads soient chevauchants (50 bp), on peut
réfléchir à une stratégie en coupant éventuellement les fragments en 2
avec des enzymes de restriction par exemple.&lt;/p&gt;

&lt;p&gt;&lt;span class=&#34;newthought&#34;&gt;Pour les manips&lt;/span&gt;
, on envisage
d&amp;rsquo;adapter le protocole pour obtenir non plus 3000 transformants mais
100 000. L&amp;rsquo;idée est que si le nombre de génomes est en large excès par
rapport au nombre de transformants effectivement séquencés, on
diminue la probabilité que deux transformants séquencés soient des
clones identiques.&lt;/p&gt;

&lt;p&gt;À l&amp;rsquo;issue de la transformation, les produits de transformations seront
étalés sur LB + kanamycine, 500µL sur boîtes de 120mm, avec un plus grand
nombre de boîte &lt;label for=&#34;error: cannot access positional params by string name&#34; class=&#34;margin-toggle sidenote-number&#34;&gt;&lt;/label&gt;
&lt;input type=&#34;checkbox&#34; id=&#34;error: cannot access positional params by string name&#34; class=&#34;margin-toggle&#34;/&gt;
&lt;span class=&#34;sidenote&#34;&gt;Incluant des réplicats biologiques ?&lt;/span&gt; 
.
Après 24h de culture, les boîtes seront raclées, et l&amp;rsquo;ADN total extrait, le locus amplifié par PCR
et les amplicons obtenus séquencés.&lt;/p&gt;

&lt;p&gt;&lt;span class=&#34;newthought&#34;&gt;Dans un second temps&lt;/span&gt;
, il faudra concevoir les gènes de synthèse incluant des flags.
La société GeneWiz basée à Londres propose des tarifs avantageux par rapport à Thermo-fischer, il faudra discuter avec eux du prix (devis pour les séquences de synthèse entière + flag). Ce flag permettra de discriminer les clones les uns des autres, et d&amp;rsquo;être sûr après séquençage de n&amp;rsquo;analyser que des reads issus de clones différents.&lt;/p&gt;

&lt;p&gt;Un problème non résolu est que la longueur maximale de séquençage sera
comprise entre 0 et 600bp, alors que notre locus d&amp;rsquo;intérêt mesure
800bp. On a brièvement mentionné le minION de Oxford Nanopore, qui
permettrait de séquencer les reads en entier. Pour l&amp;rsquo;instant, le taux
d&amp;rsquo;erreur semble trop élevé pour notre intérêt. Il existe un groupe de
travail au BBE sur le thème NGS, et Gabriel Marais a un projet en
lien.&lt;/p&gt;

&lt;p&gt;&lt;span class=&#34;newthought&#34;&gt;Notre approche&lt;/span&gt;
 est locus
dépendante. Bubendorfer &lt;em&gt;et al&lt;/em&gt; ont utilisé la transformation à
l&amp;rsquo;échelle du génome entier chez &lt;em&gt;H.pylori&lt;/em&gt;. On peut éventuellement s&amp;rsquo;inspirer de leur protocole.&lt;/p&gt;

&lt;p&gt;Ils ont deux types de protocole. Un protocole où une souche receveuse est incubée en présence d&amp;rsquo;un excès d&amp;rsquo;ADN d&amp;rsquo;une souche donneuse divergente de la receveuse à 4.5%&lt;label for=&#34;error: cannot access positional params by string name&#34; class=&#34;margin-toggle sidenote-number&#34;&gt;&lt;/label&gt;
&lt;input type=&#34;checkbox&#34; id=&#34;error: cannot access positional params by string name&#34; class=&#34;margin-toggle&#34;/&gt;
&lt;span class=&#34;sidenote&#34;&gt;Un polymorphisme toutes les 22bp.&lt;/span&gt; 
, et la manip est répétée sur 50 jours, à l&amp;rsquo;issue desquelles 20 clones ont été séquencés en short-reads. Le second protocole implique une sélection de l&amp;rsquo;intégration d&amp;rsquo;une cassette de résistance par culture sur milieu + antibiotique comme nous. Au bout d&amp;rsquo;une génération, 20 clones sont WGS.&lt;/p&gt;

&lt;p&gt;Dans un premier temps, on veut estimer le nombre de positions de marqueurs qu&amp;rsquo;ils ont pu analyser en séquençant 20 génomes entiers, ainsi que le coût associé.&lt;/p&gt;

&lt;p&gt;Dans un second temps et si l&amp;rsquo;estimation paraît favorable, on peut creuser leurs données et faire nos &amp;ldquo;&lt;a href=&#34;http://simplystatistics.org/2016/01/25/on-research-parasites-and-internet-mobs-lets-try-to-solve-the-real-problem/&#34;&gt;reasearch parasites&lt;/a&gt;&amp;rdquo;, pour voir si leurs marqueurs ne montreraient pas par hasard un biais quelconque.&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>